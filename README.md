# Ansible Jenkins Installation

This branch, `0.2_ansible_install_jenkins`, contains the necessary files to install Jenkins on an EC2 instance created by Terraform in the previous branch, `0.1_create_ec2_tf`. 

## About the Project

In the previous branch, `0.1_create_ec2_tf`, we set up EC2 instances using Terraform. Now, we will use Ansible to install Jenkins on the created EC2 instance.

## Prerequisites

- An Ubuntu EC2 instance created using the Terraform code from the `0.1_create_ec2_tf` branch.
- The `deployer` key pair generated by Terraform for accessing the EC2 instance.

## Installing Ansible on Ubuntu

```
#1.Update the package list by running the command:
sudo apt update

#2.Install the software-properties-common package by running the command:
sudo apt install software-properties-common

#3. Add the Ansible repository by running the command:
sudo apt-add-repository --yes --update ppa:ansible/ansible

#4. Install Ansible by running the command:

sudo apt install ansible
```

## Installing Jenkins using Ansible Playbook

0. Clone the repository to your local machine, if you haven't already, by running the command:

1. Switch to the `0.2_ansible_install_jenkins` branch by running the command:


```
git clone https://github.com/manikcloud/Jenkins-cicd.git
```
2. To get the public IP of the VM created by Terraform, run the following command:

```
terraform output
```

## Switch the branch 

```
git checkout 0.2_ansible_install_jenkins
```

3. Navigate to the `ansible` directory by running the command:

```
cd ansible
```

## Replace the VM ip from `terraform output` Output 

Replace the ip in files named `inventory.ini` and a host variables file named `host_vars.yml` in the same directory as your Ansible playbook. Here's an example of both files:

**inventory.ini**
```
[my_servers]
my_server ansible_host=X.X.X.X
```
Replace X.X.X.X with the public IP address of your VM.

**host_vars.yml**

```
---
ansible_user: ubuntu
ansible_ssh_private_key_file: path/to/deployer
```
Replace path/to/deployer with the correct path to your deployer key pair.

Now, update your Ansible playbook to use the my_servers group:

---
- name: Install Jenkins on Ubuntu
  hosts: my_servers
  become: yes
  gather_facts: yes
  ...

  ```
To run the playbook, use the following command:

```
ansible-playbook -i inventory.ini jenkins_installation.yaml
```
This command will use the inventory file inventory.ini and the playbook jenkins_installation.yaml. The inventory file contains the server IP address and the host variables file contains the SSH user and private key file, so you don't need to specify them in the command.

## Optionl ! Click below for ansible configuration file 
<details>
You can create a local Ansible configuration file, named `ansible.cfg`, in the same directory as your inventory file and playbook. This configuration file can contain custom settings for your project. Here's an example ansible.cfg file:

```
[defaults]
inventory = inventory.ini
remote_user = ubuntu
private_key_file = path/to/deployer
host_key_checking = False
retry_files_enabled = False
```
Replace path/to/deployer with the correct path to your deployer key pair.

With this configuration file in place, you can run the Ansible playbook without specifying the inventory file in the command:

```
ansible-playbook jenkins_installation.yaml

```

The ansible.cfg file tells Ansible to use the specified inventory file and settings by default, so you don't need to include them in the command.

</details>



## Check the connectivity from remote VM

1. To get the public IP of the VM created by Terraform, run the following command:

```
terraform output
```

This will display the output variables from your Terraform configuration. Look for the variable containing the public IP address and copy it.

2. Use the Ansible ad-hoc `ping` command to check the connectivity to the EC2 instance by running the command:

```
ansible all -i 'X.X.X.X,' --private-key=path/to/deployer -m ping
```

Replace `X.X.X.X` with the public IP address you just copied, and `path/to/deployer` with the correct path to your deployer key pair.

If the connectivity is successful, you will see output similar to the following:

```
X.X.X.X | SUCCESS => {
"ansible_facts": {
"discovered_interpreter_python": "/usr/bin/python3"
},
"changed": false,
"ping": "pong"
}
```
4. Update the `hosts` file in the `ansible` directory with the public IP address of your EC2 instance.

## Run the ansible playbok to install Jenkins
5. Run the Ansible playbook to install Jenkins using the deployer key pair by running the command:

```
ansible-playbook -i X.X.X.X,  --private-key=../deployer ansible/jenkins.yaml
```
6. Once the playbook is executed, Jenkins will be installed on the EC2 instance.

Note: Replace the path to the deployer key pair with the correct path if necessary.

7. Now follow the scrrnshot to complete the installation from this block 

https://varunmanik1.medium.com/devsecops-cicd-java-tomcat-project-141d6b73e436


# Disclaimer
<details>

Please note that the entire repository is owned and maintained by [Varun Kumar Manik](https://www.linkedin.com/in/vkmanik/). While every effort has been made to ensure the accuracy and reliability of the information and resources provided in this repository, Varun Kumar Manik takes full responsibility for any errors or inaccuracies that may be present.

Simplilearn is not responsible for the content or materials provided in this repository and disclaims all liability for any issues, misunderstandings, or claims that may arise from the use of the information or materials provided. By using this repository, you acknowledge that Varun Kumar Manik is solely accountable for its content, and you agree to hold Simplilearn harmless from any claims or liabilities that may arise as a result of your use or reliance on the information provided herein.

It is important to understand that this repository contains educational materials for a training course, and users are expected to apply their own judgment and discretion when utilizing the provided resources. Neither Varun Kumar Manik nor Simplilearn can guarantee specific results or outcomes from following the materials in this repository.

</details>

## Connect & Follow


